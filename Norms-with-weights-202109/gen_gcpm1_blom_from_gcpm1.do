gen spgcpm11=gcpm1
gen spgcpm12 = (max((gcpm1--.1678)^3,0)-(.2965999999999999-.141)^-1 * (max((gcpm1-.141)^3,0)*(.2965999999999999--.1678)-max((gcpm1-.2965999999999999)^3,0)*(.141--.1678))) / (.2965999999999999--.1678)^2 if missing(gcpm1)~=1
gen spgcpm13 = (max((gcpm1-.025)^3,0)-(.2965999999999999-.141)^-1 * (max((gcpm1-.141)^3,0)*(.2965999999999999-.025)-max((gcpm1-.2965999999999999)^3,0)*(.141-.025))) / (.2965999999999999--.1678)^2 if missing(gcpm1)~=1
gen Pgcpm1_blom = -.5687583743190936+spgcpm11*6.283523134762985+spgcpm12*.1713529655098197+spgcpm13*4.794234195298108
* have a nice day
